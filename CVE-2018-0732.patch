--- openssl-1.0.2o/crypto/dh/dh_key.c~	2019-09-10 13:06:55.000000000 -0500
+++ openssl-1.0.2o/crypto/dh/dh_key.c	2019-09-10 13:07:57.930725903 -0500
@@ -133,10 +133,15 @@
     int ok = 0;
     int generate_new_key = 0;
     unsigned l;
-    BN_CTX *ctx;
+    BN_CTX *ctx = NULL;
     BN_MONT_CTX *mont = NULL;
     BIGNUM *pub_key = NULL, *priv_key = NULL;
 
+    if (BN_num_bits(dh->p) > OPENSSL_DH_MAX_MODULUS_BITS) {
+        DHerr(DH_F_GENERATE_KEY, DH_R_MODULUS_TOO_LARGE);
+        return 0;
+    }
+
 #ifdef OPENSSL_FIPS
     if (FIPS_mode()
         && (BN_num_bits(dh->p) < OPENSSL_DH_FIPS_MIN_MODULUS_BITS)) {
